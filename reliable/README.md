This is a sliding window algorithm.
